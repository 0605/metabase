#!/usr/bin/env bash

case $CIRCLE_NODE_INDEX in
    0) ENGINES=h2,mongo,mysql,bigquery lein test ;;
    1) ENGINES=h2,sqlserver MB_DB_TYPE=postgres MB_DB_DBNAME=circle_test MB_DB_PORT=5432 MB_DB_USER=ubuntu MB_DB_HOST=localhost lein test ;;
    2) ENGINES=h2,postgres,sqlite,crate MB_DB_TYPE=mysql MB_DB_DBNAME=circle_test MB_DB_PORT=3306 MB_DB_USER=ubuntu MB_DB_HOST=localhost lein test ;;
    3) ENGINES=h2,redshift,druid lein test ;;
    4) lein eastwood && lein bikeshed && lein docstring-checker && ./bin/reflection-linter ;;
    5) npm install && npm run lint && npm run test ;;
    6) ./bin/build && npm run test-e2e ;;
esac
